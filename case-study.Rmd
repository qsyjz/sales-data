---
title: "Case Study for the module of Scientific Programming and Mathematical Modelling"
author: 'Student ID: 5552339'
date: "2024-05-07"
output:
  pdf_document: default
  html_document:
    df_print: paged
mainfont: Times New Roman
fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# 1. Introduction
The media company Bisney aims to understand the relationship between advertising expenditures across TV, radio, and newspapers, and the sales performance of their action figure toy over the past three years. With a dataset of 200 observations, they want to uncover which advertisement channels are most influential in driving toy sales.

The purpose of this study is to analyze the effect of advertising expenditures on toy sales for Bisney's action figure product line. Specifically, the study aims to determine the most effective advertising channel among TV, radio, and newspaper. The study also aims to showcase a step-by-step mathematical modeling approach. Finally, the study addresses the strategic question of advising Bisney on how to distribute its resources among the three advertising channels to achieve a target of 30 thousand toy sales in the next period. 

The study begins by framing the case of Bisney, focusing on the link between advertising spending and toy sales. It progresses through preliminary data analysis, descriptive data analysis, and inferential data analysis, concluding with a summary of findings and recommendations.

Using RStudio, the study simplifies assumptions and identifies independent variables (TV, radio, newspaper spending) and the dependent variable (toy sales). Data types and missing values are checked to ensure dataset integrity, and the suitability of data is checked using Central Limit Theorem with histograms. Descriptive analysis follows, where distribution(histogram), central tendency(mean/median) and spread(standard deviation/range) of each group of data are shown. Inferential analysis uses correlation and regression to show relationships, while p-value and Root Mean Square Error are used to check the significance and accuracy. Comparing seven linear regressions models, each of the advertisements and sales performance is shown, the advertising with the most impact is found and the allocation of source in terms of a specific target sale is suggested. 


# 2. Analysis

## 2.1. Definitions
The report contains a series of terms, which are defined as follows:

*histogram/normal distribution/...?

* Central Limit Theorem (CLT): A fundamental principle in statistics stating that the sampling distribution of the sample mean approaches a normal distribution as the sample size increases, regardless of the shape of the population distribution. 

* Measure of central tendency: A statistical measure used to describe the center of a data set. Common measures of central tendency include the mean (average), median (middle value), and mode (most frequent value). 

* Measure of spread: A statistical measure that describes the variability data points in a dataset. Common measures of spread include the range (difference between the maximum and minimum values), variance (average of the squared differences from the mean), and standard deviation (square root of the variance). 

* Linear regression:  A statistical method used to model the relationship between a dependent variable (response) and one or more independent variables (predictors) by fitting a linear equation to observed data.

* P-value: In statistical hypothesis testing, the p-value is the probability of obtaining results as extreme as the observed results, assuming that the null hypothesis is true. A low p-value in linear regression model indicates that the relation between the two variables is insignificant.

* Root Mean Square Error (RMSE): A measure of the differences between values predicted by a model or estimator and the observed values. RMSE represents the square root of the average of the squared differences between predicted and observed values, and lower RMSE shows higher accuracy.


## 2.2. Preliminary data analysis

**1. Summarize the variables and data types**

The dataset comprises four variables: TV, Radio, Newspaper, and Sales. Each variable is represented as numeric data type.

```{r}
library(readr)
sales_data <- read_csv("https://raw.githubusercontent.com/qsyjz/sales-data/main/SPAMMSA3.csv")

str(sales_data)
```

**2.Check for missing value and clean the data** 

```{r} 
missing_value <- colSums(is.na(sales_data))
```
There is no missing value present across any of the variables, so no data cleaning procedures are required.


**3.Suitability of data**

To check the suitability of data using CLT, histograms with distribution curve can show whether the data is normally distributed and suitable.

```{r}
#TV:
tv_mean <- mean(sales_data$TV)
tv_median <- median(sales_data$TV)
tv_range <- range(sales_data$TV)
tv_sd <- sd(sales_data$TV)
tv_sd <- sd(sales_data$TV)

x_tv <- seq(0, 400, length=1000)  
y_tv <- dnorm(x_tv, mean=tv_mean, sd=tv_sd)  

hist(sales_data$TV, main="Figure 1: TV Advertising Expenditure Distribution", xlab="TV Advertising Expenditure (GBP)", freq=FALSE,cex.main=0.9)
lines(x_tv, y_tv, col="blue")
```
Figure 1 shows that the distribution of TV advertising expenditure data is left-skewed, but is still approximately normal. Thus this group of sample data can be used in the study.

```{r}
radio_mean <- mean(sales_data$Radio)
radio_median <- median(sales_data$Radio)
radio_range <- range(sales_data$Radio)
radio_sd <- sd(sales_data$Radio)

x <- seq(0, 400, length=1000)  
y <- dnorm(x, mean=radio_mean, sd=radio_sd)  

hist(sales_data$Radio, main="Figure 2: Radio Advertising Expenditure Distribution", xlab="Radio Advertising Expenditure (GBP)", freq=FALSE,ylim=c(0, 0.03),cex.main=0.9)
lines(x, y, col="blue")
```
Figure 2 shows that the distribution of radio advertising expenditure data is left-skewed, but is still approximately normal. Thus this group of sample data can be used in the study.

```{r}
newspaper_mean <- mean(sales_data$Newspaper)
newspaper_median <- median(sales_data$Newspaper)
newspaper_range <- range(sales_data$Newspaper)
newspaper_sd <- sd(sales_data$Newspaper)
x <- seq(0, 400, length=1000)  
y <- dnorm(x, mean=radio_mean, sd=radio_sd)  

hist(sales_data$Radio, main="Figure 3: Newspaper Advertising Expenditure Distribution", xlab="Newspaper Advertising Expenditure (GBP)", freq=FALSE,ylim=c(0, 0.03),cex.main=0.9)
lines(x, y, col="blue")
```
Figure 3 shows that the distribution of newspaper advertising expenditure data is left-skewed, but is still approximately normal. Thus this group of sample data can be used in the study.


```{r}
sales_mean <- mean(sales_data$Sales)
sales_median <- median(sales_data$Sales)
sales_range <- range(sales_data$Sales)
sales_sd <- sd(sales_data$Sales)

x <- seq(0, 400, length=1000)  
y <- dnorm(x, mean=sales_mean, sd=sales_sd)  

hist(sales_data$Sales, main="Figure 4: Sales Distribution", xlab="Toy Sales (thousands)", freq=FALSE,ylim=c(0, 0.08),cex.main=0.9)
lines(x, y, col="blue")
```
Figure 4 shows that the distribution of radio advertising expenditure data is symmetrical. Therefore this group of sample data follows normal distribution and can be used in the study.




## 2.3. Descriptive data analysis

**1. TV Advertising Expenditure**

```{r}
tv_median <- median(sales_data$TV)
tv_range <- max(sales_data$TV)-min(sales_data$TV)
```
From Figure1, TV advertising expenditure has a left-skewed distribution. Thus, median is suitable to measure the central tendency since it won't be affected by outliers. The median is 165.6937 GBP, showing the middle value of the data. Since standard deviation can also be affected by outliers, range is suitable for the measure of spread. The range of this group of data is 388.2614 GBP, indicating the observed TV advertising expenditure values span a large range of 388.2614 GBP.


**2. Radio Advertising Expenditure**

```{r}
radio_median <- median(sales_data$Radio)
radio_range <- max(sales_data$Radio)-min(sales_data$Radio)
```

From Figure 2, Radio advertising expenditure also has a left-skewed distribution. Thus the central tendency can be measured by median, which is 23.82003 GBP. Similarly, range is suitable for the measure of spread, which is 58.35869 GBP and is the span of observed Radio advertising expenditure.
  
  

**3. Newspaper Advertising Expenditure**

```{r}
newspaper_median <- median(sales_data$Newspaper)
newspaper_range <- max(sales_data$Newspaper)-min(sales_data$Newspaper)
```

From Figure 3, Newspaper advertising expenditure also has a left-skewed distribution. Thus the central tendency can be measured by median, which is  30.48269 GBP. Similarly, range is suitable for the measure of spread, which is 85.39051 GBP and is the span of observed Radio advertising expenditure.


**4. Sales**

```{r}
sales_mean <- mean(sales_data$Sales)
sales_sd <- sd(sales_data$Sales)
```

From Figure 4, the number of toy sales follows a normal distribution. The mean is appropriate for measure of central tendency because the distribution is relatively symmetrical and it provides a balanced representation of the data. The mean is 15.20364 thousand, showing the average level of toy sales in this period. Likewise, standard deviation is suit for the measure of spread since it can show the variability more accurately then range and there are few outliers. The standard deviation indicates that on average, toy sales in the dataset deviate from the mean (average sales) by approximately 5.032199 thousand.


## 2.4. Inferential data analysis
By performing the correlation analysis between TV-Sales, Radio-sales, and newspaper-sales, scatter graphs are drawn as follows:

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = TV, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 5: Relationship between TV Advertising expenditure and Sales" ))) 
model_tv <- lm(Sales ~ TV, data = sales_data)
gg + theme(plot.title = element_text(size = 12, hjust = 0.5))

#accuracy: 
mse_tv <- mean(model_tv$residuals^2)
rmse_tv <- sqrt(mse_tv)
#rmse_tv
#summary(model_tv)
```

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = Radio, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 6: Relationship between Radio Advertising expenditure and Sales" ))) 
model_radio <- lm(Sales ~ Radio, data = sales_data)
gg + theme(plot.title = element_text(size = 12, hjust = 0.5))

#accuracy:
mse_radio <- mean(model_radio$residuals^2)
rmse_radio <- sqrt(mse_radio)
# rmse_radio

# summary(model_radio)
```

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = Newspaper, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 7: Relationship between Newspaper Advertising expenditure and Sales" ))) 
model_newspaper <- lm(Sales ~ Newspaper, data = sales_data)
gg + theme(plot.title = element_text(size = 11, hjust = 0.5))

#accuracy:
mse_newspaper <- mean(model_newspaper$residuals^2)
rmse_newspaper <- sqrt(mse_newspaper)
rmse_newspaper
summary(model_newspaper)
```

The regression functions are $y=15.74-0.0034x$, $y=15.29-0.0036x$, $y=14.49+0.0226x$ respectively. Combining the graphs, the gradients of the regression lines show that only newspaper advertising expenditure has positive correlation with the toy sales and has the biggest impact on it.

In the linear regression models, except for the 
four variables referred in the previous part, the independent variables also need contain combined advertising expenditure: the sum of TV and radio advertising expenditure, the sum of TV and newspaper's expenditure, the sum of radio and neswpaper's expenditure and the sum of all the advertising expenditure, so that suggestions on resource allocation can be given. These four regression models are as following:

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = TR, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 8: Relationship between TV, Radio Advertisement and Sales"))) 
model_TR <- lm(Sales ~ TR, data = sales_data)
gg + theme(plot.title = element_text(size = 12, hjust = 0.5))


#accuracy:
mse_TR <- mean(model_TR$residuals^2)
rmse_TR <- sqrt(mse_TR)
# rmse_TR
# summary(model_TR)
```
Regression fuction: $y=15.8213-0.0034x$

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = TN, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 9: Relationship between TV, Newspaper Advertising expenditure and Sales"))) 
model_TN <- lm(Sales ~ TN, data = sales_data)
gg + theme(plot.title = element_text(size = 12, hjust = 0.5))

#accuracy:
mse_TN <- mean(model_TN$residuals^2)
rmse_TN <- sqrt(mse_TN)
# rmse_TN
# summary(model_TN)
```
Regression function: $y=15.6194-0.0022x$

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = RN, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 10: Relationship between Radio and Newspaper Advertising expenditure and Sales"))) 
model_RN <- lm(Sales ~ RN, data = sales_data)
gg + theme(plot.title = element_text(size = 10, hjust = 0.5))

#accuracy:
mse_RN <- mean(model_RN$residuals^2)
rmse_RN <- sqrt(mse_RN)
# rmse_RN
# summary(model_RN)
```
Regression function: $y=14.4137+0.0142x$

```{r}
library(ggplot2)
gg <- ggplot(sales_data, aes(x = TRN, y = Sales)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + ggtitle(bquote(bold("Figure 11: Relationship between TV, Radio, Newspaper Advertising expenditure and Sales"))) 
model_TRN <- lm(Sales ~ TRN, data = sales_data)
gg + theme(plot.title = element_text(size = 10, hjust = 0.5))

#accuracy:
mse_TRN <- mean(model_TRN$residuals^2)
rmse_TRN <- sqrt(mse_TRN)
# rmse_TRN
# summary(model_TRN)
```
Regression function: $y=15.6782-0.0022x$



To check the significance and the accuracy of all the models, p-value and the Root Mean Square Error (RMSE) can be used. The p-values of the regression models are 0.4172, 0.8897, 0.251, 0.4128, 0.5875, 0.3855 and 0.5779 respectively, which are all larger then 0.05. Thus all the seven models can't show significant relation between the variables. 
The RMSE values of the models are 5.011253, 5.019358, 5.002886,   5.011085, 5.015865,  5.010043,  5.015669 seperately. The RMSE of newspaper advertising expenditure is the smallest, showing this model is the most accurate among the seven. 

Comparing all the seven regressions lines, the newspaper advertising expenditure has the biggest positive impact on toy sales, whose regression model is also the most accurate. Therefore, to achieve the 30 thousand sales of toy, the company can focus on the newspaper advertising. By using the third regression function $y=14.49+0.0226x$, the company would need to allocate approximately 1,327,687.61 GBP for Newspaper advertising. 



## 3. Conclusion

In conclusion, this study aimed to analyze the effect of advertising expenditures on toy sales for Bisney's action figure product line. The research investigates the relationship between advertising spending across different channels (TV, radio, newspaper and four combined advertising) and toy sales over a three-year period. 

From regression analysis and correlation measures, newspaper advertising expenditure showed the most significant positive impact on toy sales. The regression model based on it is also the most accurate compared to others. To achieve the target of 30 thousand toy sales, the study recommends focusing resources on newspaper advertising. The regression analysis suggests an allocation of approximately £1,327,687.61 for newspaper advertising to achieve the desired sales target.


Additionally, there are a few possible limitations in the research. Firstly, the analysis relied on a dataset in a specific time frame, which may not capture long-term trends in toy sales and advertising effectiveness. Secondly, the analysis certain simplifying assumptions about the relationship between advertising expenditures and toy sales, which may oversimplify the complex dynamics of consumer behavior and market trends. Also, for the solution of achieving the 30 thousand's sale target is impractical since the company can't only use one type of advertisement.
Therefore, for future analysis or decision makers, this study is referenced and provides some sensible analysis approaches. Yet they need further research with a larger sample size from a wider time span, and more variables with more sophisticated models are needed.  
